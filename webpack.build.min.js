var config = require('./webpack.build.js')
var webpack = require('webpack')
var path = require('path')
var CopyWebpackPlugin = require('copy-webpack-plugin')

config.output.filename = config.output.filename.replace(/\.js$/, '.min.js')

delete config.devtool

config.plugins.push(
  new webpack.optimize.UglifyJsPlugin({
    sourceMap: false,
    drop_console: true,
    compress: {
      warnings: false
    }
  }),
  // copy custom static assets
  new CopyWebpackPlugin([
    {
      from: path.resolve(__dirname, './static'),
      to: path.resolve(__dirname, './dist'),
      ignore: ['.*']
    }
  ])
)

module.exports = config